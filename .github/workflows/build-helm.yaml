name: build-push-helm

on:
  push:
    # branches:
    #   - 'main'
    paths:
      - .github/workflows/build-helm.yml
      - helm/*

env:
  IMAGE_PREFIX: kalioz/test-nginx-autobuild

jobs:
  docker:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Package and publish Helm Chart
        uses: kalioz-github-action/github-actions/actions/package-helm-chart-chartmuseum@cloiselet/feat-add-helm-action
        with:
          folder: "charts/simple-webapp"
          chartmuseum_url: http://chartmuseum.chartmuseum.svc.cluster.local:8080